# ConvertEasy 开发路线图

> 最后更新: 2024-12-17

## 📊 功能完成度概览

| 模块          | 完成度 | 状态        |
| ------------- | ------ | ----------- |
| PDF 转换      | 75%    | 🟠 需改进   |
| 音频转换      | 85%    | 🟡 基本可用 |
| Markdown 转换 | 0%     | 🔴 未实现   |
| 文档互转      | 60%    | 🟠 需改进   |

---

## 🔴 P0 - 紧急/阻断性问题

> 这些问题会导致功能完全不可用或严重影响用户体验

### Issue #1: Markdown 转换功能完全缺失

- **模块**: 文档转换
- **影响**: 用户无法进行任何 Markdown 相关转换
- **现状**:
  - 后端 `config.py` 未包含 `.md` 扩展名
  - 无 `md->*` 转换脚本
  - 前端 `formats.js` 未声明 Markdown 格式
- **需要**:
  - [ ] 添加 `.md` 到 `ALLOWED_DOC_EXT`
  - [ ] 创建 `md_to_html.py` 脚本
  - [ ] 创建 `md_to_pdf.py` 脚本
  - [ ] 创建 `md_to_docx.py` 脚本
  - [ ] 更新 `PYTHON_CONVERSIONS` 映射
  - [ ] 更新前端格式配置

### Issue #2: WMA 音频格式声称支持但实际未实现

- **模块**: 音频转换
- **影响**: 用户选择 WMA 转换会失败或产生错误输出
- **现状**:
  - 前端 `AUDIO_CONVERSION_MAP` 包含 `wma`
  - 后端 `converter.py` 的 `format_params` 缺少 `wma` 配置
- **需要**:
  - [ ] 添加 WMA 的 FFmpeg 参数配置
  - [ ] 验证 WMA 编解码器可用性

### Issue #3: Word→HTML 转换脚本存在逻辑 Bug

- **模块**: 文档转换
- **影响**: 转换内容可能错乱
- **现状**:

  ```python
  # doc_to_html.py 第46行
  paragraph = doc.paragraphs[doc.element.body.index(element)]  # 索引计算错误
  ```

- **需要**:
  - [ ] 重写段落遍历逻辑
  - [ ] 添加单元测试验证

---

## 🟠 P1 - 高优先级问题

> 这些问题严重影响转换质量，用户可能会抱怨结果不可用

### Issue #4: PDF→Word 图片完全丢失

- **模块**: PDF 转换
- **影响**: 转换后的 Word 文档缺失所有图片
- **现状**:
  - `pdf_to_doc.py` 只提取文本
  - PyMuPDF 有 `get_images()` 能力但未使用
- **需要**:
  - [ ] 使用 PyMuPDF 提取图片
  - [ ] 将图片插入 Word 文档对应位置
  - [ ] 处理图片格式兼容性

### Issue #5: PDF→Word 格式/样式全部丢失

- **模块**: PDF 转换
- **影响**: 输出文档无格式，仅纯文本
- **现状**: 字体、颜色、字号、对齐等信息未保留
- **需要**:
  - [ ] 考虑引入 `pdf2docx` 库（更好的格式保留）
  - [ ] 或增强现有脚本的样式映射

### Issue #6: PDF→Excel 只提取第一个表格

- **模块**: PDF 转换
- **影响**: 多表格 PDF 丢失大部分数据
- **现状**:

  ```python
  # pdf_to_xls.py
  df = pd.DataFrame(tables[0][1:], columns=tables[0][0])  # 只处理tables[0]
  ```

- **需要**:
  - [ ] 遍历所有表格
  - [ ] 每个表格写入独立 Sheet
  - [ ] 添加表格来源页码信息

### Issue #7: PDF→PPT 转换质量极差

- **模块**: PDF 转换
- **影响**: 输出 PPT 几乎不可用
- **现状**:
  - 仅将每页文本放入幻灯片
  - 丢失所有布局、图片、图表
- **需要**:
  - [ ] 提取并嵌入图片
  - [ ] 智能识别标题和内容区域
  - [ ] 考虑按 PDF 原始布局创建幻灯片

### Issue #8: 扫描件/图片 PDF 无法处理

- **模块**: PDF 转换
- **影响**: 大量扫描文档无法转换
- **现状**: 只输出"无文本内容"提示
- **需要**:
  - [ ] 集成 OCR 引擎（Tesseract / PaddleOCR）
  - [ ] 添加图片预处理（去噪、二值化）
  - [ ] 支持多语言 OCR

---

## 🟡 P2 - 中优先级问题

> 这些问题影响用户体验但不阻断核心功能

### Issue #9: HTML→PDF 中文字体支持问题

- **模块**: 文档转换
- **影响**: 中文可能显示为方块或乱码
- **现状**: xhtml2pdf 默认字体不支持中文
- **需要**:
  - [ ] 注册中文字体（SimSun, Microsoft YaHei）
  - [ ] 添加字体回退机制

### Issue #10: HTML→Word 图片未嵌入

- **模块**: 文档转换
- **影响**: HTML 中的图片丢失
- **现状**: `html_to_word.py` 未处理 `<img>` 标签
- **需要**:
  - [ ] 下载/读取图片资源
  - [ ] 使用 python-docx 插入图片

### Issue #11: 音频转换丢失元数据

- **模块**: 音频转换
- **影响**: 转换后丢失歌手、专辑、封面等信息
- **现状**: FFmpeg 命令未包含元数据复制参数
- **需要**:
  - [ ] 添加 `-map_metadata 0` 参数
  - [ ] 或使用 mutagen 库迁移标签

### Issue #12: PDF→TXT 缺少降级处理

- **模块**: PDF 转换
- **影响**: 特定 PDF 可能转换失败
- **现状**: `pdf_to_txt.py` 只用 pdfplumber，无备选
- **需要**:
  - [ ] 添加 pdfminer 和 PyMuPDF 作为备选
  - [ ] 参考 `pdf_to_doc.py` 的多引擎策略

### Issue #13: 文件大小限制错误提示不友好

- **模块**: 通用
- **影响**: 用户不理解为何上传失败
- **现状**: 可能返回通用 500 错误
- **需要**:
  - [ ] 在上传前检查文件大小
  - [ ] 返回清晰的大小限制提示

---

## 🟢 P3 - 低优先级/增强功能

> 这些是改进项，当前功能可用

### Issue #14: 转换进度实时反馈

- **模块**: 通用
- **现状**: 用户只能轮询状态，无进度百分比
- **需要**:
  - [ ] 在长时间转换中提供进度更新
  - [ ] 考虑 WebSocket 推送

### Issue #15: 批量转换支持

- **模块**: 通用
- **现状**: 一次只能转换一个文件
- **需要**:
  - [ ] 支持多文件上传
  - [ ] 批量任务管理

### Issue #16: 转换结果预览

- **模块**: 通用
- **现状**: 只能下载后查看
- **需要**:
  - [ ] 在线预览转换结果
  - [ ] 支持常见格式的预览

### Issue #17: 转换历史记录

- **模块**: 通用
- **现状**: 任务完成后无法查看历史
- **需要**:
  - [ ] 持久化任务记录
  - [ ] 历史列表页面

### Issue #18: 音频采样率/比特率可配置

- **模块**: 音频转换
- **现状**: 使用固定参数
- **需要**:
  - [ ] 允许用户选择质量级别
  - [ ] 高级用户可自定义参数

### Issue #19: 添加更多格式支持

- **模块**: 通用
- **待添加格式**:
  - [ ] EPUB（电子书）
  - [ ] MOBI（Kindle 电子书）
  - [ ] LaTeX
  - [ ] 图片格式互转（PNG, JPG, WEBP）

---

## 📋 技术债务

### TD-1: 测试覆盖率不足

- 许多转换脚本缺少单元测试
- 需要添加边界条件测试

### TD-2: 错误处理不统一

- 各脚本错误处理方式不一致
- 需要统一错误格式和日志

### TD-3: 配置硬编码

- 部分参数硬编码在脚本中
- 应迁移到配置文件

### TD-4: 缺少性能监控

- 无转换耗时统计
- 无资源使用监控

---

## 📝 开发建议优先级

```
1. P0 Issues → 先修复阻断性问题
2. P1 Issues → 提升核心功能质量
3. 技术债务 → 并行处理
4. P2 Issues → 逐步优化
5. P3 Issues → 按需实现
```

---

## 🔗 相关文档

- [后端 README](./backend/README.md)
- [快速开始指南](./backend/QUICK_START.md)
- [API 测试说明](./backend/tests/POSTMAN_README.md)
- [小程序配置说明](./miniprogram/CONFIG.md)
